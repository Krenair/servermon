{% extends "base.html" %}

{% block title %}Updates for {{ host.name }}{% endblock %}
{% block heading %}{{ host.name }}: Host information{% endblock %}
{% block content %}
<h2>System information</h2>
<div class="hostinfo">
<table>
{% for attr in system|dictsort:"name" %}
{% if attr.value %}<tr><th>{{ attr.name }}</th><td>{{ attr.value }}</td></tr>{% endif %}
{% endfor %}
{% if ispuppet %}<tr><th>Last updated</th><td>{{ host.updated_at|date }}</td></tr>{% endif %}
</table>
</div>

<h2>Network information<div class="control"><a href="#" onclick="javascript:$('#netinfo').toggle();">Toggle</a></div></h2>
<table id="netinfo">
<tr><th>Interface name</th><th>IP Address</th><th>MAC Address</th>{% if isvm %}<th>Host interface</th><th>Bridge</th>{% endif %}</tr>
{% for iface in interfaces %}
<tr><td>{{iface.iface}}</td><td class="mono">{% if iface.ipaddr %}{{iface.ipaddr}}{% else %}&mdash;{% endif %}</td><td class="mono">{% if iface.mac %}{{iface.mac}}{% else %}&mdash;{% endif %}</td>{% if isvm %}<td>{{ iface.hostif }}</td><td>{{ iface.bridge }}</td>{% endif %}</tr>
{% endfor %}
</table>

{% if vmdisks %}
<h2>Disks</h2>
<table>
<tr><th>Guest device</th><th>Host device</th></tr>
{% for disk in vmdisks %}
<tr><td class="mono">{{ disk.target }}</td><td class="mono">{{ disk.source }}</td></tr>
{% endfor %}
</table>
{% endif %}

{% if contacts %}
<h2>Virtual machine contacts</h2>
{% if node.reachable %}
<p>This is the list of contacts for the currently running virtual machines on this host.</p>
{% else %}
<p>The host's virtualization hypervisor is <span class="error">unreachable</span><br />
This is the list of contacts for virtual machines last seen running when the host was up and not currently running elsewhere.</p>
{% endif %}
{% regroup contacts by contact as contact_list %}
<table>
{% for contact in contact_list %}
<tr><th>{{ contact.grouper }}</th></tr>
<tr><td>
	{% for vm in contact.list %}
	{{ vm.vm.name }}<br />
	{% endfor %}
</td></tr>
{% endfor %}
</table>
{% endif %}

{% if ispuppet %}
<h2>Available package updates</h2>
{% if updates %}
<table>
<tr><th>Package name</th>	<th>Installed Version</th>	<th>Available Version</th></tr>
{% for update in updates %}
<tr><td><a href="/packages/{{ update.package.name }}">{{ update.package.name }}</a></td><td>{{ update.installedVersion }}</td>	<td class="changelog"><a href="{{ update.get_changelog_url }}" target="_blank">{{ update.candidateVersion }}</a></td></tr>
{% endfor %}
</table>
<div class="instructions">
<ul>
<li>Click on the available version number to view the package's changelog for that version</li>
<li>Click on a package name to see all hosts with pending updates on that package</li>
</ul>
</div>
{% else %}
<div align="center">
<strong>No updated versions found for packages on {{ host.name }}</strong>
</div>
{% endif %}
{% endif %}
{% endblock %}
